#!/usr/bin/env bash
# seq - Short alias for sequential execution

# Get script directory with robust path resolution
if command -v realpath >/dev/null 2>&1; then
    SCRIPT_DIR="$(realpath "$(dirname "${BASH_SOURCE[0]}")")"
elif command -v readlink >/dev/null 2>&1 && readlink -f "${BASH_SOURCE[0]}" >/dev/null 2>&1; then
    SCRIPT_DIR="$(dirname "$(readlink -f "${BASH_SOURCE[0]}")")"
else
    SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
fi
SEQUENTIAL_EXECUTOR="${SCRIPT_DIR}/sequential-executor.sh"
WAIT_ALL="${SCRIPT_DIR}/wait_all.sh"

# Check if both scripts exist
if [ ! -x "$SEQUENTIAL_EXECUTOR" ]; then
    echo "ERROR: sequential-executor.sh not found or not executable" >&2
    exit 1
fi

if [ ! -x "$WAIT_ALL" ]; then
    echo "ERROR: wait_all.sh not found or not executable" >&2
    exit 1
fi

# Use wait_all.sh to ensure proper process completion
"$WAIT_ALL" -- "$SEQUENTIAL_EXECUTOR" "$@"
